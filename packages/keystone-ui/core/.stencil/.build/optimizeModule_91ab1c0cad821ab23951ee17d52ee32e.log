import{r as t,c as e,l as s,h as i,H as a,a as o}from"./p-BVbYP5UG.js";import{d as r}from"./p-O1A-ZSZs.js";import{S as n}from"./p-DtH7945i.js";import{t as h,d as l}from"./p-B9Bv72kO.js";import{s as d}from"./p-BpTTFEEs.js";import{g as c}from"./p-B29l_iU6.js";import{g as f,i as p}from"./p-H-KPsjGO.js";import{c as u}from"./p-BLeWSNPN.js";import{d as m}from"./p-CqdmgBk0.js";import{g as b}from"./p-Cg-hFIOP.js";import{V as k}from"./p-DTAuyNBn.js";import{r as g}from"./p-DOsoKeKK.js";import{d as y,c as v}from"./p-CZoCRgNL.js";import{F as w}from"./p-CkSrI1o0.js";import{F as x}from"./p-C5l2lh22.js";import"@oddbird/popover-polyfill";import"./p-BsdBppw3.js";import"./p-B85MJLTf.js";import"./p-lK2WYNKL.js";import"./p-BKnx-nkd.js";import"./p-B7eN8IFF.js";import"./p-DXVWym72.js";import"./p-3aNLeb18.js";import"./p-D53F0nW8.js";const j='@charset "UTF-8";ul,li{list-style:none;margin:0;padding:0}button{border:none;margin:0;padding:0;width:auto;overflow:visible;background:transparent;color:inherit;font:inherit;line-height:normal;-webkit-font-smoothing:inherit;-moz-osx-font-smoothing:inherit;-webkit-appearance:none}button::-moz-focus-inner{border:0;padding:0}.ks-text-bodyMd{font-size:var(--ks-text-bodyMd-fontSize);line-height:var(--ks-text-bodyMd-lineHeight);font-weight:var(--ks-text-bodyMd-fontWeight);letter-spacing:var(--ks-text-bodyMd-letterSpacing);font-family:var(--ks-text-bodyMd-fontFamily)}@keyframes breathing-opacity{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}.ks-skeleton,.animate-pulse{background-color:var(--ks-color-neutral-surface3);border-radius:var(--ks-border-radius-sm);animation-name:breathing-opacity;animation-duration:2s;animation-timing-function:cubic-bezier(0.455, 0, 0.55, 1);animation-fill-mode:forwards;animation-iteration-count:infinite}.ks-card-section{margin-bottom:var(--ks-spacing-400);font-size:var(--ks-text-titleMd-fontSize);line-height:var(--ks-text-titleMd-lineHeight);font-weight:var(--ks-text-titleMd-fontWeight);letter-spacing:var(--ks-text-titleMd-letterSpacing);font-family:var(--ks-text-titleMd-fontFamily)}*,:host{box-sizing:border-box}[ks-picker-base]::part(wc-input){width:250px}.quickOption{width:100%;padding:var(--ks-spacing-200);border-radius:var(--ks-border-radius-md);cursor:pointer;font-size:var(--ks-text-bodySm-fontSize);line-height:var(--ks-text-bodySm-lineHeight);font-weight:var(--ks-text-bodySm-fontWeight);letter-spacing:var(--ks-text-bodySm-letterSpacing);font-family:var(--ks-text-bodySm-fontFamily)}.quickOption:hover,.quickOption:focus{background-color:var(--ks-color-neutral-surfaceHover)}.quickOption:active{background-color:var(--ks-color-neutral-surfaceActive)}.quickOption--selected{color:var(--ks-color-primary-onSurface)}.quickOption--disabled{cursor:not-allowed;color:var(--ks-color-primary-onSurfaceDisabled)}.preset-container{max-height:298px;overflow-y:auto;scrollbar-width:none}.footer{display:flex;flex-direction:row;gap:var(--ks-spacing-100)}';var S=undefined&&undefined.__decorate||function(t,e,s,i){var a=arguments.length,o=a<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,s):i,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(t,e,s,i);else for(var n=t.length-1;n>=0;n--)if(r=t[n])o=(a<3?r(o):a>3?r(e,s,o):r(e,s))||o;return a>3&&o&&Object.defineProperty(e,s,o),o};const M="MMMM d, yyyy";const O=()=>false;const D=class extends w{get locale(){return d.state.config.locale}get valueDate(){if(typeof this.value==="string"){throw Error("Invalid value, value must be Array")}return(this.value||[]).filter((t=>!!t)).map((t=>{if(typeof t==="string"){return m(t).toDate()}return t}))}set valueDate(t){this.value=t;if(this.value?.length===2){if(this.valueFormatInChangeEvent){this.ksChange.emit(this.valueDate.map((t=>r.format(t,this.valueFormatInChangeEvent))))}else{this.ksChange.emit(this.formattedDate)}!this.needConfirm&&this.popperRef.close()}}get formattedDate(){return this.valueDate.map((t=>r.format(t,this.format)))}handleValueChange(t){if(this.needConfirm){this.cacheValue(t.detail)}else{this.valueDate=t.detail}}async resetActiveView(){this.dateRangePanelRef?.resetActiveView()}async closePanel(){this.popperRef?.close()}async openPanel(){this.popperRef?.open()}constructor(s){super();t(this,s);this.ksChange=e(this,"ksChange",1);this.ksShow=e(this,"ksShow",1);this.ksHide=e(this,"ksHide",1);this.ksVisibleChange=e(this,"ksVisibleChange",1);this.ksClear=e(this,"ksClear",1);this["ks-name"]="ks-date-range-picker";this.format=M;this.placement="bottom-start";this.showPreset=false;this.hasTimezone=true;this.extraQuickOptions=[];this.timeZoneDisplayPosition="picker";this.needConfirm=false;this.hasCachedValue=false;this.confirmValue=()=>{this.cachedValue=null;this.hasCachedValue=false;this.valueDate=this.value;this.popperRef.close()};this.cancelValue=()=>{if(this.hasCachedValue){this.value=this.cachedValue;this.hasCachedValue=false}this.popperRef.close()};this.isVisible=false;g(this.el)}formatValueDisplay(){if(!this.valueDate){return""}return this.valueDate.map((t=>{if(!this.format||this.format===M){return c(r.toDate(t),this.locale)}return r.format(t,this.format)})).join(" – ")}get timeZoneToday(){const{timezoneOffset:t}=d.state.i18n;const e=new Date;const s=(e.getTimezoneOffset()+t)*60*1e3;const i=new Date(e.getTime()+s);return r.startOfDay(i)}getLastNDaysPreset(t){return[r.sub(this.timeZoneToday,{days:t}),t?r.sub(this.timeZoneToday,{days:1}):this.timeZoneToday]}getLastNWeeksPreset(t){let e=r.startOfWeek(this.timeZoneToday,{weekStartsOn:f(this.locale)%7});let s;if(t>1){e=r.sub(e,{weeks:t});s=r.sub(r.endOfWeek(this.timeZoneToday),{weeks:1})}else if(t!==0){e=r.sub(e,{weeks:t});s=r.add(e,{days:6})}else{s=this.timeZoneToday}return[e,s]}getLastNMonthsPreset(t){let e=r.startOfMonth(this.timeZoneToday);let s;if(t>1){e=r.sub(e,{months:t});s=r.sub(r.endOfMonth(this.timeZoneToday),{months:1})}else if(t!==0){e=r.sub(e,{months:t});s=r.endOfMonth(e)}else{s=this.timeZoneToday}return[e,s]}checkExtraQuickOptions(t=this.extraQuickOptions){if(!Array.isArray(t))return[];return t.map((t=>{if(!Array.isArray(t.dates)||t.dates.length!==2){s.warn("Invalid quick option format:",t);return null}try{const e=t.dates.map((t=>{if(typeof t==="string"){const e=m(t).toDate();if(isNaN(e.getTime())){throw new Error(`Invalid date string: ${t}`)}return e}if(t instanceof Date){if(isNaN(t.getTime())){throw new Error("Invalid Date object")}return t}throw new Error(`Unsupported date type: ${typeof t}`)}));return{...t,dates:e}}catch(e){s.error("Error processing quick option:",e.message,t);return null}})).filter(Boolean)}getQuickOptionPreset(){const t=this.checkExtraQuickOptions();let e;if(this.overridePreset){e=this.overridePreset.map((t=>{if(t.endsWith("M")){const e=parseInt(t.replace("L",""));if(e<=1){return{label:p(-e,"months",this.locale),dates:this.getLastNMonthsPreset(e)}}else{return{label:h(y.lastNMonths,{months:e}),dates:this.getLastNMonthsPreset(e)}}}else if(t.endsWith("W")){const e=parseInt(t.replace("L",""));return{label:p(-e,"weeks",this.locale),dates:this.getLastNWeeksPreset(e)}}else if(t.endsWith("D")){const e=parseInt(t.replace("L",""));if(e<=1){return{label:p(-e,"days",this.locale),dates:this.getLastNDaysPreset(e)}}else{return{label:h(y.lastNDays,{days:e}),dates:this.getLastNDaysPreset(e)}}}}))}else{e=[{label:p(0,"days",this.locale),dates:this.getLastNDaysPreset(0)},{label:p(-1,"days",this.locale),dates:this.getLastNDaysPreset(1)},{label:h(y.lastNDays,{days:7}),dates:this.getLastNDaysPreset(7)},{label:h(y.lastNDays,{days:14}),dates:this.getLastNDaysPreset(14)},{label:h(y.lastNDays,{days:30}),dates:this.getLastNDaysPreset(30)},{label:p(0,"weeks",this.locale),dates:this.getLastNWeeksPreset(0)},{label:p(-1,"weeks",this.locale),dates:this.getLastNWeeksPreset(1)},{label:p(0,"months",this.locale),dates:this.getLastNMonthsPreset(0)},{label:p(-1,"months",this.locale),dates:this.getLastNMonthsPreset(1)}]}return[...t.filter((t=>t?.position==="top")),...e,...t.filter((t=>t?.position==="bottom"))]}cacheValue(t){this.hasCachedValue=true;this.cachedValue=this.value;this.value=t}render(){const{disabled:t,status:e}=b(this);return i(a,{key:"dcf56c9a4e2da07bc2c69895b5fc48742e1c9d4e",dir:l(),"ks-date-range-picker":true},i("ks-picker-base",{key:"4455254477d7dc2270dd3a5b6f7aacb166112bc7",exportparts:"field: field",timezone:this.timezone,hasTimezone:this.hasTimezone,timeZoneDisplayPosition:this.timeZoneDisplayPosition,readonly:true,placeholder:this.placeholder||`${h(y.start)} – ${h(y.end)}`,startPlaceholder:h(y.start),endPlaceholder:h(y.end),disabled:t,status:e,width:this.width,clearable:this.clearable,value:this.formatValueDisplay(),placement:this.placement,longTimezone:this.longTimezone,showLongTimeZone:this.needConfirm,onKsShow:()=>{this.ksVisibleChange.emit(true);this.ksShow?.emit?.();this.isVisible=true;this.resetActiveView()},onKsHide:()=>{this.ksVisibleChange.emit(false);this.isVisible=false;this.ksHide?.emit?.()},onKsClear:()=>{this.ksClear.emit();this.ksChange.emit(["",""])},popoverRef:t=>this.popperRef=t,"data-testid":"range-date-range-picker-axGby2"},this.prefixSlot&&i("slot",{key:"4dc09aa69c101535afdfffdeb1cb8f22e6bbbf5f",slot:"prefix",name:"prefix"}),this.showIconSlot&&i("slot",{key:"e9fe063373882c9781e7aa5e24985fd1bfdd231c",name:"show-icon",slot:"show-icon"}),this.suffixSlot&&i("slot",{key:"d6ae661e597893ad630482954c2529014af8ae3c",name:"suffix",slot:"suffix"}),this.closeIconSlot&&i("slot",{key:"27be90ffca60d40567b6a0ce9be4ceb873a60874",name:"close-icon",slot:"close-icon"}),i("ks-date-range-panel",{key:"2c3baf4f884087bad4d405b7e57e6bdc0b6ceb08",ref:t=>this.dateRangePanelRef=t,onKsChange:this.handleValueChange.bind(this),value:this.previewDate??this.valueDate,disabledDate:this.isVisible?this.disabledDate:O,"data-testid":"range-date-range-picker-ecpvx2"},(this.presetSlot||this.showPreset)&&i("div",{key:"1a420b4f03033adb816baa36a5e9534b9b93879a",slot:"preset",class:"preset-container"},i("slot",{key:"501b9204eeff21ef043115717393008ea9601607",name:"preset"},this.getQuickOptionPreset().map((t=>{const[e,s]=t.dates;const a=r.isSameDay(e,this.valueDate[0])&&r.isSameDay(s,this.valueDate[1]);const o=this.isVisible&&Boolean(this.disabledDate?.(e,true,e)||this.disabledDate?.(s,false,e));return i("div",{class:u("quickOption",a&&"quickOption--selected",o&&"quickOption--disabled"),onPointerEnter:()=>!o&&(this.previewDate=[e,s]),onPointerLeave:()=>this.previewDate=undefined,onClick:()=>!o&&this.handleValueChange({detail:[e,s]}),"data-testid":"range-date-range-picker-cMzMM4"},t.label)}))))),i("slot",{key:"681f25eb2137a30e8158e99cfd5e25a71093de40",slot:"footer",name:"footer"},this.needConfirm&&i("div",{key:"5a952723993442be5ab4b4bec5a004bb38839483",class:`footer`},i("ks-button",{key:"39dc702fc2a6a7c6e60f4a6cdfa759b8abf28e97",size:"sm",onClick:this.cancelValue,"data-testid":"range-date-range-picker-7NehV7"},h(v.cancel)),i("ks-button",{key:"dc393d56f421e7af28ed398918c3d12f7e86c00d",variant:"primary",size:"sm",onClick:this.confirmValue,"data-testid":"range-date-range-picker-whjtJA"},h(v.confirm))))))}get el(){return o(this)}};S([n({slotname:"preset"})],D.prototype,"presetSlot",void 0);S([n({slotname:"show-icon"})],D.prototype,"showIconSlot",void 0);S([n({slotname:"close-icon"})],D.prototype,"closeIconSlot",void 0);S([n({slotname:"suffix"})],D.prototype,"suffixSlot",void 0);S([n({slotname:"prefix"})],D.prototype,"prefixSlot",void 0);S([k(),x()],D.prototype,"value",void 0);D.style=j;export{D as ks_date_range_picker};