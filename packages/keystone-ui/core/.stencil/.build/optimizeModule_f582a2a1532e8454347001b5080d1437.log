var e;(function(e){e["ALL"]="all";e["PARENT"]="parent";e["CHILD"]="child";e["INDEPENDENT"]="independent"})(e||(e={}));var t;(function(e){e["FLOOR_KEY"]="__floor";e["FULL_VALUE_KEY"]="__fullValue";e["FULL_LABEL_KEY"]="__fullLabel";e["PARENT_FULL_VALUE_KEY"]="__pFullValue";e["FULL_PATH_KEY"]="__fullPath";e["LABEL_FULL_PATH_KEY"]="__labelFullPath";e["LEAFS_VALUE_KEY"]="__leafsValue";e["PARENT_KEY"]="__parent";e["ORIGIN_DATA"]="__originData"})(t||(t={}));class i{constructor(e){this.rootFloor=-1;const{fullpathMode:t=false,valueKey:i="value",labelKey:s="label",childrenKey:n="children",disabledKey:l="disabled",needLoadKey:r="needLoad"}=e;this.fullpathMode=t;this.valueKey=i;this.labelKey=s;this.childrenKey=n;this.disabledKey=l;this.needLoadKey=r;this.data={}}createRootNode(){return{[t.FLOOR_KEY]:this.rootFloor}}createData(e=[],i){if(i!==undefined&&e?.length){this.btRemoveLeaf(i)}const s=this;const{valueKey:n,labelKey:l,childrenKey:r,fullpathMode:a,unValidVal:c}=this;const h=i!==undefined?i:this.createRootNode();h[this.childrenKey]=[...h[this.childrenKey]||[],...e];const o={};function d(e,i,h){for(let u=0;u<h.length;u++){const f=h[u];f[t.FLOOR_KEY]=e;if(a){f[t.FULL_VALUE_KEY]=c(i[t.FULL_VALUE_KEY])?`${f[n]}`:`${i[t.FULL_VALUE_KEY]}/${f[n]}`;f[t.FULL_LABEL_KEY]=c(i[t.FULL_LABEL_KEY])?`${f[l]}`:`${i[t.FULL_LABEL_KEY]}/${f[l]}`}else{f[t.FULL_VALUE_KEY]=f[n];f[t.FULL_LABEL_KEY]=f[l]}f[t.FULL_PATH_KEY]=[].concat(i[t.FULL_PATH_KEY]||[],f[t.FULL_VALUE_KEY]);f[t.LABEL_FULL_PATH_KEY]=[].concat(i[t.LABEL_FULL_PATH_KEY]||[],f[t.FULL_LABEL_KEY]);f[t.PARENT_FULL_VALUE_KEY]=i[t.FULL_VALUE_KEY];f[t.PARENT_KEY]=i;if(!c(f[t.FULL_VALUE_KEY])){o[f[t.FULL_VALUE_KEY]]=f}if(f[r]?.length){d(e+1,f,f[r])}else{if(!s.ignoreOption(f)){s.btAddLeaf(f)}}}}d(0,h,e);i===undefined&&(this.data=o);return o}btAddLeaf(e){let i=e[t.PARENT_KEY];while(i&&i[t.FLOOR_KEY]!==this.rootFloor){if(i[t.LEAFS_VALUE_KEY]instanceof Array){i[t.LEAFS_VALUE_KEY].push(e[t.FULL_VALUE_KEY])}else{i[t.LEAFS_VALUE_KEY]=[e[t.FULL_VALUE_KEY]]}i=i[t.PARENT_KEY]}}btRemoveLeaf(e){let i=e[t.PARENT_KEY];while(i&&i[t.FLOOR_KEY]!==this.rootFloor){const s=i[t.LEAFS_VALUE_KEY];s.splice(s.indexOf(e[t.FULL_VALUE_KEY]),1);i=i[t.PARENT_KEY]}}insertNode(e,t){const i=this.createData(e,t);Object.assign(this.data,i);return this.data}isSelectedInSingleMode(e,i){return i===e[t.FULL_VALUE_KEY]}isSelectedInMultipleMode(i,s,n){if(this.isRootNode(i)){let e=false;let t=false;const l=[];const r=[];i[this.childrenKey]?.forEach((e=>{const{selected:t,isIndeterminate:i}=this.isSelectedInMultipleMode(e,s,n);l.push(t);r.push(i)}));e=l.every((e=>e));t=!e&&l.some((e=>e))||r.some((e=>e));return{selected:e,isIndeterminate:t}}let l=false;let r=false;let a=0;function c(){return i[t.LEAFS_VALUE_KEY]?.filter((e=>s?.has(e))).length||0}if(s?.size){const h=s?.has(i[t.FULL_VALUE_KEY]);if(n===e.INDEPENDENT){l=h}else if(n===e.ALL){const e=c();l=h;r=!h&&e>0&&e<i[t.LEAFS_VALUE_KEY]?.length}else if(n===e.PARENT){const e=i[t.FULL_PATH_KEY]?.some((e=>s?.has(e)));l=h||e&&!this.ignoreOption(i);i[this.childrenKey]?.forEach((e=>{const{selected:t}=this.isSelectedInMultipleMode(e,s,n);if(t){a++}}));this.visitChildrenNodeBfs(i,(e=>{if(e[this.childrenKey]?.some((e=>s.has(e[t.FULL_VALUE_KEY])))){r=true;return true}return false}))}else if(n===e.CHILD){const e=c();l=h||e===i[t.LEAFS_VALUE_KEY]?.length;r=e>0&&e<i[t.LEAFS_VALUE_KEY]?.length}}return{selected:l,isIndeterminate:r,count:a}}singleSelect(i,s){return new Promise(((n,l)=>{if(s===e.INDEPENDENT||!i[this.childrenKey]?.length&&!i[this.needLoadKey]){n(i[t.FULL_VALUE_KEY])}else{l(new Error("Option selection failed due to invalid strategy or missing children."))}}))}addSelfValue2Selected(e,i){const s=e[t.FULL_VALUE_KEY];i.add(s)}addChildValue2Selected(e,i){if(e[t.LEAFS_VALUE_KEY]){e[t.LEAFS_VALUE_KEY].forEach((e=>{i.add(e)}))}else{i.add(e[t.FULL_VALUE_KEY])}}addParentValue2Selected(e,i){const s=e=>{const s=[e];while(s.length){const e=s.shift();i.delete(e[t.FULL_VALUE_KEY]);if(e[this.childrenKey]?.length){e[this.childrenKey].forEach((e=>{s.push(e)}))}}};s(e);const n=e=>{i.add(e[t.FULL_VALUE_KEY]);const s=e[t.PARENT_KEY];if(s?.[this.childrenKey]?.length&&s[t.FLOOR_KEY]!==this.rootFloor){const e=s[this.childrenKey].every((e=>{if(this.ignoreOption(e)){return true}return i.has(e[t.FULL_VALUE_KEY])}));if(e&&(s.selectable||s.selectable===undefined)){s[this.childrenKey].forEach((e=>i.delete(e[t.FULL_VALUE_KEY])));n(s)}}};n(e)}addEveryValue2Selected(e,i){const s=e=>{if(e&&!this.ignoreOption(e)){i.add(e[t.FULL_VALUE_KEY]);e[this.childrenKey]?.forEach((e=>{s(e)}))}};s(e);const n=e=>{const s=e[t.PARENT_KEY];const l=s[this.childrenKey].every((e=>{if(this.ignoreOption(e)){return true}return i.has(e[t.FULL_VALUE_KEY])}));if(l){i.add(s[t.FULL_VALUE_KEY]);n(s)}};n(e)}multipleAddSelect(e,t,i){if(this.isRootNode(e)){e[this.childrenKey]?.forEach((e=>{this.multipleAddSelect(e,t,i)}));return}switch(i){case"independent":this.addSelfValue2Selected(e,t);break;case"child":this.addChildValue2Selected(e,t);break;case"all":this.addEveryValue2Selected(e,t);break;case"parent":this.addParentValue2Selected(e,t);break;default:this.addParentValue2Selected(e,t);break}}removeSelfValue2Selected(e,i){const s=e[t.FULL_VALUE_KEY];i.delete(s)}removeChildValue2Selected(e,i){if(e[t.LEAFS_VALUE_KEY]){e[t.LEAFS_VALUE_KEY].forEach((e=>{i.delete(e)}))}else{i.delete(e[t.FULL_VALUE_KEY])}}removeParentValue2Selected(e,i){const s=n=>{if(i.has(n[t.FULL_VALUE_KEY])){const s=n=>{i.delete(n[t.FULL_VALUE_KEY]);if(n===e)return;n[this.childrenKey]?.forEach((n=>{if(this.ignoreOption(n)){return}if(e[t.FULL_PATH_KEY].includes(n[t.FULL_VALUE_KEY])){s(n);return}i.add(n[t.FULL_VALUE_KEY])}))};s(n)}else{s(n[t.PARENT_KEY])}};s(e)}removeEveryValue2Selected(e,i){const s=e=>{const n=e[t.PARENT_KEY];const l=i.has(n[t.FULL_VALUE_KEY]);if(l){i.delete(n[t.FULL_VALUE_KEY]);s(n)}};s(e);const n=e=>{if(e){i.delete(e[t.FULL_VALUE_KEY]);e[this.childrenKey]?.forEach((e=>{n(e)}))}};n(e)}multipleRemoveSelect(e,t,i){if(this.isRootNode(e)){e[this.childrenKey]?.forEach((e=>{this.multipleRemoveSelect(e,t,i)}));return}switch(i){case"independent":this.removeSelfValue2Selected(e,t);break;case"child":this.removeChildValue2Selected(e,t);break;case"all":this.removeEveryValue2Selected(e,t);break;case"parent":this.removeParentValue2Selected(e,t);break;default:this.removeParentValue2Selected(e,t);break}}unValidVal(e){return[undefined,"",NaN].includes(e)}ignoreOption(e){const i=e=>{if(e[t.FLOOR_KEY]===this.rootFloor){return false}if(e[this.disabledKey]){return true}return i(e[t.PARENT_KEY])};const s=i(e);return s}visitChildrenNodeBfs(e,t){const i=[e];let s=false;while(i.length&&!s){const e=i.shift();s=t?.(e);i.push(...e[this.childrenKey]||[])}}isRootNode(e){return e[t.FLOOR_KEY]===this.rootFloor}}export{t as E,i as T};