{"version":3,"names":["SearchController","constructor","component","this","_performSearch","searchString","ignoreCase","searchResultList","queryPatt","RegExp","escapeRegExp","result","datasource","_datasourceMap","datasourceMap","search","undefined","key","option","push","String","EnumTreeItemKeys","FULL_VALUE_KEY","match","FULL_LABEL_KEY","searchChangeHandler","detail","ksSearchChange","emit","searchValue","queryString","debouncedSearch","debounce","searchDebounceTime"],"sources":["src/utils/cascader/search.ts"],"sourcesContent":["import type { KsCascader } from '@src/components/ks-cascader';\nimport type { KsMultipleCascader } from '@src/components/ks-cascader/multiple';\nimport type { DataSourceMap } from '@src/entities/components/cascader';\nimport type { KsInputCustomEvent } from '@src/components';\nimport { debounce } from 'lodash-es';\nimport { escapeRegExp } from '../utils';\nimport { EnumTreeItemKeys } from '../tree/treeMap';\n\nexport class SearchController {\n  private component: KsCascader | KsMultipleCascader;\n\n  constructor(component: KsCascader | KsMultipleCascader) {\n    this.component = component;\n    this.debouncedSearch = debounce(this._performSearch, this.component.searchDebounceTime);\n  }\n\n  private _performSearch = (searchString: string) => {\n    const ignoreCase = this.component.ignoreCase;\n    if (!searchString) {\n      this.component.searchResultList = [];\n      return;\n    }\n    const queryPatt = ignoreCase ? new RegExp(escapeRegExp(searchString), 'i') : new RegExp(escapeRegExp(searchString));\n    const result = [];\n\n    let datasource: DataSourceMap;\n    if (this.component['ks-name'] === 'ks-multiple-cascader') {\n      datasource = (this.component as KsMultipleCascader)._datasourceMap;\n    } else {\n      datasource = this.component.datasourceMap;\n    }\n\n    if (this.component.search !== undefined) {\n      for (const key in datasource) {\n        const option = datasource[key];\n        // @ts-expect-error TYPE_FIXME. Please Fix the below strict mode type error. Read https://bytedance.sg.larkoffice.com/docx/MIsKdGOQwoQsnuxrsxEl6AsYgCf\n        if (this.component.search(searchString, option)) {\n          result.push(option);\n        }\n      }\n    } else {\n      for (const key in datasource) {\n        const option = datasource[key];\n        if (\n          // @ts-expect-error TYPE_FIXME. Please Fix the below strict mode type error. Read https://bytedance.sg.larkoffice.com/docx/MIsKdGOQwoQsnuxrsxEl6AsYgCf\n          String(option[EnumTreeItemKeys.FULL_VALUE_KEY]).match(queryPatt) ||\n          // @ts-expect-error TYPE_FIXME. Please Fix the below strict mode type error. Read https://bytedance.sg.larkoffice.com/docx/MIsKdGOQwoQsnuxrsxEl6AsYgCf\n          String(option[EnumTreeItemKeys.FULL_LABEL_KEY]).match(queryPatt)\n        ) {\n          result.push(option);\n        }\n      }\n    }\n    // @ts-expect-error TYPE_FIXME. Please Fix the below strict mode type error. Read https://bytedance.sg.larkoffice.com/docx/MIsKdGOQwoQsnuxrsxEl6AsYgCf\n    this.component.searchResultList = result;\n  };\n\n  public debouncedSearch: (query: string) => void;\n\n  public searchChangeHandler = ({ detail }: KsInputCustomEvent<string>) => {\n    this.component.ksSearchChange.emit(detail);\n    if (this.component.searchValue === undefined) {\n      this.component.queryString = detail;\n    }\n  };\n}\n"],"mappings":"kHAQaA,EAGX,WAAAC,CAAYC,GAKJC,KAAAC,eAAkBC,IACxB,MAAMC,EAAaH,KAAKD,UAAUI,WAClC,IAAKD,EAAc,CACjBF,KAAKD,UAAUK,iBAAmB,GAClC,M,CAEF,MAAMC,EAAYF,EAAa,IAAIG,OAAOC,EAAaL,GAAe,KAAO,IAAII,OAAOC,EAAaL,IACrG,MAAMM,EAAS,GAEf,IAAIC,EACJ,GAAIT,KAAKD,UAAU,aAAe,uBAAwB,CACxDU,EAAcT,KAAKD,UAAiCW,c,KAC/C,CACLD,EAAaT,KAAKD,UAAUY,a,CAG9B,GAAIX,KAAKD,UAAUa,SAAWC,UAAW,CACvC,IAAK,MAAMC,KAAOL,EAAY,CAC5B,MAAMM,EAASN,EAAWK,GAE1B,GAAId,KAAKD,UAAUa,OAAOV,EAAca,GAAS,CAC/CP,EAAOQ,KAAKD,E,OAGX,CACL,IAAK,MAAMD,KAAOL,EAAY,CAC5B,MAAMM,EAASN,EAAWK,GAC1B,GAEEG,OAAOF,EAAOG,EAAiBC,iBAAiBC,MAAMf,IAEtDY,OAAOF,EAAOG,EAAiBG,iBAAiBD,MAAMf,GACtD,CACAG,EAAOQ,KAAKD,E,GAKlBf,KAAKD,UAAUK,iBAAmBI,CAAM,EAKnCR,KAAAsB,oBAAsB,EAAGC,aAC9BvB,KAAKD,UAAUyB,eAAeC,KAAKF,GACnC,GAAIvB,KAAKD,UAAU2B,cAAgBb,UAAW,CAC5Cb,KAAKD,UAAU4B,YAAcJ,C,GAlD/BvB,KAAKD,UAAYA,EACjBC,KAAK4B,gBAAkBC,EAAS7B,KAAKC,eAAgBD,KAAKD,UAAU+B,mB","ignoreList":[]}