import{i as t,l as s}from"./p-BVbYP5UG.js";import{a as o}from"./p-B9Bv72kO.js";export{d as dir}from"./p-B9Bv72kO.js";import{B as i,s as e,i as r}from"./p-BpTTFEEs.js";import{i as n}from"./p-D7jkzT0S.js";export{B as BaseModal,m as modal}from"./p-Brn5wDkJ.js";export{T as TreeMap}from"./p-ClUjZ4dQ.js";import{i as a}from"./p-DVUvlQwI.js";export{k as ks}from"./p-DMO-AHJn.js";import"@oddbird/popover-polyfill";import"./p-DLGSjaFz.js";import"./p-DY__klQW.js";class c{constructor(t=i){this.idCounter=0;this.queue=new Map;this.info=this.createVariantMethod("info","info");this.success=this.createVariantMethod("success","success");this.warning=this.createVariantMethod("warning","warning");this.error=this.createVariantMethod("error","error");this.loading=this.createVariantMethod("info","loading");this.container=t}findTopLayerContainer(){const t=Array.from(document.querySelectorAll("[ks-modal], [ks-drawer]"));for(const s of t){const t=s.shadowRoot?.querySelector("[ks-overlay]");if(t?.open){const s=t.shadowRoot?.children?.[0];if(s)return s}}return null}createVariantMethod(t,s){return o=>{const i={iconName:s,variant:t,showIcon:true};const e=this.normalizeConfig(o);return this.open({...i,...e})}}handleToastClose(t){const s=this.queue.get(t);if(!s)return;this.queue.delete(t);this.onToastRemoved(t,s);s.resolve()}getToastsByContainer(t){return Array.from(this.queue.values()).filter((s=>this.getContainer(s.config.container)===t))}getContainer(t){if(t){return t}const s=this.findTopLayerContainer();if(s){return s}return this.container}open(t){const s=`toast-${Date.now()}-${++this.idCounter}`;const o=this.normalizeConfig(t);const i=new Promise((t=>{this.queue.set(s,{id:s,config:o,resolve:t});this.onToastAdded(s,o)}));const e=()=>{this.handleToastClose(s)};return Object.assign(e,{then:i.then.bind(i),catch:i.catch.bind(i)})}closeAll(){this.queue.forEach((t=>t.resolve()));this.queue.clear();this.onAllToastsClosed()}}class h extends c{constructor(){super();this.toastBoxEl=document.createElement("ks-toast-box")}configureToastElement(s,i){const{btm:e,btmConfig:r,customStyle:n,...a}=i;Object.entries(a).forEach((([t,i])=>o(s,t,i)));if(t(n)){s.customStyle=n}s.setAttribute("data-btm",e);if(r){s.setAttribute("data-btm-config",t(r)?JSON.stringify(r):r.toString())}}setupToastLifecycle(t,o,i){o.cbAfterDidLoad=()=>{o.open()};o.addEventListener("ksClose",(()=>{if(i===this.container){if(this.queue.size===0&&this.container.contains(this.toastBoxEl)){try{this.container.removeChild(this.toastBoxEl)}catch(t){s.warn("Failed to remove toast box:",t)}}}this.handleToastClose(t)}))}normalizeConfig(s){if(n(s)){return{content:s}}return t(s)?s:{}}onToastAdded(t,o){const i=this.getContainer(o.container);let e;if(i!==this.container){e=document.createElement("ks-toast-box");if(!i.contains(e)){i.appendChild(e)}}else{e=this.toastBoxEl;if(!this.container.contains(this.toastBoxEl)){this.container.appendChild(this.toastBoxEl)}}const r=document.createElement("ks-toast");r.setAttribute("data-toast-id",t);this.configureToastElement(r,o);try{e.appendChild(r);this.setupToastLifecycle(t,r,e)}catch(t){s.error("Failed to create toast:",t)}}onToastRemoved(t){const s=document.querySelector(`ks-toast[data-toast-id="${t}"]`);if(s&&typeof s.close==="function"){s.close()}}onAllToastsClosed(){try{if(this.container.contains(this.toastBoxEl)){this.container.removeChild(this.toastBoxEl)}}catch(t){s.warn("Failed to remove toast box:",t)}}}const f=new h;function l(t,s){if(!s){return t}const o={...t,...s};if(a(t,o)){return t}else{return o}}function p(t){const s=e.get("config");const o=typeof t.locale==="object"?t.locale?.__lang__:t.locale;e.set("config",{locale:r(o)?o:"en",lockScroll:l(s.lockScroll,t.lockScroll),zIndex:l(s.zIndex,t.zIndex)});if(t.i18n){e.set("i18n",l(e.get("i18n"),{...t.i18n,isManuallySet:true}))}}export{c as BaseToast,r as isSupportedLocale,p as setGlobalConfig,f as toast};