import{r as t,c as r,m as e,h as i,H as n,a as s}from"./p-BVbYP5UG.js";import{P as a}from"./p-DXVWym72.js";import{F as o}from"./p-lK2WYNKL.js";import{d as f}from"./p-B9Bv72kO.js";import{c as u}from"./p-BLeWSNPN.js";import{p as l,i as c,a as h,m as d,b as v,c as m}from"./p-Cg-hFIOP.js";import{b as p,c as g,t as b,g as y}from"./p-3aNLeb18.js";import{S as x,I as _}from"./p-CwVJOw7w.js";import{b as w}from"./p-v2UvMO11.js";import"@oddbird/popover-polyfill";import"./p-BKnx-nkd.js";import"./p-BpTTFEEs.js";import"./p-B85MJLTf.js";import"./p-D53F0nW8.js";function k(t,r,e){var i=-1,n=t.length;if(r<0){r=-r>n?0:n+r}e=e>n?n:e;if(e<0){e+=n}n=r>e?0:e-r>>>0;r>>>=0;var s=Array(n);while(++i<n){s[i]=t[i+r]}return s}function F(t){var r=t==null?0:t.length;return r?t[r-1]:undefined}function j(t,r){return r.length<2?t:p(t,k(r,0,-1))}var S=Object.prototype;var z=S.hasOwnProperty;function O(t,r){r=g(r,t);var e=-1,i=r.length;if(!i){return true}var n=t==null||typeof t!=="object"&&typeof t!=="function";while(++e<i){var s=r[e];if(typeof s!=="string"){continue}if(s==="__proto__"&&!z.call(t,"__proto__")){return false}if(s==="constructor"&&e+1<i&&typeof r[e+1]==="string"&&r[e+1]==="prototype"){if(n&&e===0){continue}return false}}var a=j(t,r);return a==null||delete a[b(F(r))]}function E(t,r,e){return t==null?t:w(t,r,e)}function A(t,r){return t==null?true:O(t,r)}function C(){C=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var i in e){if(Object.prototype.hasOwnProperty.call(e,i)){t[i]=e[i]}}}return t};return C.apply(this,arguments)}function R(t,r){t.prototype=Object.create(r.prototype);t.prototype.constructor=t;M(t,r)}function V(t){V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function t(r){return r.__proto__||Object.getPrototypeOf(r)};return V(t)}function M(t,r){M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(r,e){r.__proto__=e;return r};return M(t,r)}function D(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(t){return false}}function P(t,r,e){if(D()){P=Reflect.construct.bind()}else{P=function t(r,e,i){var n=[null];n.push.apply(n,e);var s=Function.bind.apply(r,n);var a=new s;if(i)M(a,i.prototype);return a}}return P.apply(null,arguments)}function T(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function L(t){var r=typeof Map==="function"?new Map:undefined;L=function t(e){if(e===null||!T(e))return e;if(typeof e!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof r!=="undefined"){if(r.has(e))return r.get(e);r.set(e,i)}function i(){return P(e,arguments,V(this).constructor)}i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:false,writable:true,configurable:true}});return M(i,e)};return L(t)}var W=/%[sdj%]/g;var N=function t(){};if(typeof process!=="undefined"&&process.env&&"production"!=="production");function B(t){if(!t||!t.length)return null;var r={};t.forEach((function(t){var e=t.field;r[e]=r[e]||[];r[e].push(t)}));return r}function I(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),i=1;i<r;i++){e[i-1]=arguments[i]}var n=0;var s=e.length;if(typeof t==="function"){return t.apply(null,e)}if(typeof t==="string"){var a=t.replace(W,(function(t){if(t==="%%"){return"%"}if(n>=s){return t}switch(t){case"%s":return String(e[n++]);case"%d":return Number(e[n++]);case"%j":try{return JSON.stringify(e[n++])}catch(t){return"[Circular]"}break;default:return t}}));return a}return t}function $(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function q(t,r){if(t===undefined||t===null){return true}if(r==="array"&&Array.isArray(t)&&!t.length){return true}if($(r)&&typeof t==="string"&&!t){return true}return false}function J(t,r,e){var i=[];var n=0;var s=t.length;function a(t){i.push.apply(i,t||[]);n++;if(n===s){e(i)}}t.forEach((function(t){r(t,a)}))}function U(t,r,e){var i=0;var n=t.length;function s(a){if(a&&a.length){e(a);return}var o=i;i=i+1;if(o<n){r(t[o],s)}else{e([])}}s([])}function H(t){var r=[];Object.keys(t).forEach((function(e){r.push.apply(r,t[e]||[])}));return r}var K=function(t){R(r,t);function r(r,e){var i;i=t.call(this,"Async Validation Error")||this;i.errors=r;i.fields=e;return i}return r}(L(Error));function Z(t,r,e,i,n){if(r.first){var s=new Promise((function(r,s){var a=function t(e){i(e);return e.length?s(new K(e,B(e))):r(n)};var o=H(t);U(o,e,a)}));s["catch"]((function(t){return t}));return s}var a=r.firstFields===true?Object.keys(t):r.firstFields||[];var o=Object.keys(t);var f=o.length;var u=0;var l=[];var c=new Promise((function(r,s){var c=function t(e){l.push.apply(l,e);u++;if(u===f){i(l);return l.length?s(new K(l,B(l))):r(n)}};if(!o.length){i(l);r(n)}o.forEach((function(r){var i=t[r];if(a.indexOf(r)!==-1){U(i,e,c)}else{J(i,e,c)}}))}));c["catch"]((function(t){return t}));return c}function Y(t){return!!(t&&t.message!==undefined)}function G(t,r){var e=t;for(var i=0;i<r.length;i++){if(e==undefined){return e}e=e[r[i]]}return e}function X(t,r){return function(e){var i;if(t.fullFields){i=G(r,t.fullFields)}else{i=r[e.field||t.fullField]}if(Y(e)){e.field=e.field||t.fullField;e.fieldValue=i;return e}return{message:typeof e==="function"?e():e,fieldValue:i,field:e.field||t.fullField}}}function Q(t,r){if(r){for(var e in r){if(r.hasOwnProperty(e)){var i=r[e];if(typeof i==="object"&&typeof t[e]==="object"){t[e]=C({},t[e],i)}else{t[e]=i}}}}return t}var tt=function t(r,e,i,n,s,a){if(r.required&&(!i.hasOwnProperty(r.field)||q(e,a||r.type))){n.push(I(s.messages.required,r.fullField))}};var rt=function t(r,e,i,n,s){if(/^\s+$/.test(e)||e===""){n.push(I(s.messages.whitespace,r.fullField))}};var et;var it=function(){if(et){return et}var t="[a-fA-F\\d:]";var r=function r(e){return e&&e.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""};var e="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}";var i="[a-fA-F\\d]{1,4}";var n=("\n(?:\n(?:"+i+":){7}(?:"+i+"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:"+i+":){6}(?:"+e+"|:"+i+"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:"+i+":){5}(?::"+e+"|(?::"+i+"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:"+i+":){4}(?:(?::"+i+"){0,1}:"+e+"|(?::"+i+"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:"+i+":){3}(?:(?::"+i+"){0,2}:"+e+"|(?::"+i+"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:"+i+":){2}(?:(?::"+i+"){0,3}:"+e+"|(?::"+i+"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:"+i+":){1}(?:(?::"+i+"){0,4}:"+e+"|(?::"+i+"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::"+i+"){0,5}:"+e+"|(?::"+i+"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim();var s=new RegExp("(?:^"+e+"$)|(?:^"+n+"$)");var a=new RegExp("^"+e+"$");var o=new RegExp("^"+n+"$");var f=function t(i){return i&&i.exact?s:new RegExp("(?:"+r(i)+e+r(i)+")|(?:"+r(i)+n+r(i)+")","g")};f.v4=function(t){return t&&t.exact?a:new RegExp(""+r(t)+e+r(t),"g")};f.v6=function(t){return t&&t.exact?o:new RegExp(""+r(t)+n+r(t),"g")};var u="(?:(?:[a-z]+:)?//)";var l="(?:\\S+(?::\\S*)?@)?";var c=f.v4().source;var h=f.v6().source;var d="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)";var v="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*";var m="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";var p="(?::\\d{2,5})?";var g='(?:[/?#][^\\s"]*)?';var b="(?:"+u+"|www\\.)"+l+"(?:localhost|"+c+"|"+h+"|"+d+v+m+")"+p+g;et=new RegExp("(?:^"+b+"$)","i");return et};var nt={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i};var st={integer:function t(r){return st.number(r)&&parseInt(r,10)===r},float:function t(r){return st.number(r)&&!st.integer(r)},array:function t(r){return Array.isArray(r)},regexp:function t(r){if(r instanceof RegExp){return true}try{return!!new RegExp(r)}catch(t){return false}},date:function t(r){return typeof r.getTime==="function"&&typeof r.getMonth==="function"&&typeof r.getYear==="function"&&!isNaN(r.getTime())},number:function t(r){if(isNaN(r)){return false}return typeof r==="number"},object:function t(r){return typeof r==="object"&&!st.array(r)},method:function t(r){return typeof r==="function"},email:function t(r){return typeof r==="string"&&r.length<=320&&!!r.match(nt.email)},url:function t(r){return typeof r==="string"&&r.length<=2048&&!!r.match(it())},hex:function t(r){return typeof r==="string"&&!!r.match(nt.hex)}};var at=function t(r,e,i,n,s){if(r.required&&e===undefined){tt(r,e,i,n,s);return}var a=["integer","float","array","regexp","object","method","email","number","date","url","hex"];var o=r.type;if(a.indexOf(o)>-1){if(!st[o](e)){n.push(I(s.messages.types[o],r.fullField,r.type))}}else if(o&&typeof e!==r.type){n.push(I(s.messages.types[o],r.fullField,r.type))}};var ot=function t(r,e,i,n,s){var a=typeof r.len==="number";var o=typeof r.min==="number";var f=typeof r.max==="number";var u=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var l=e;var c=null;var h=typeof e==="number";var d=typeof e==="string";var v=Array.isArray(e);if(h){c="number"}else if(d){c="string"}else if(v){c="array"}if(!c){return false}if(v){l=e.length}if(d){l=e.replace(u,"_").length}if(a){if(l!==r.len){n.push(I(s.messages[c].len,r.fullField,r.len))}}else if(o&&!f&&l<r.min){n.push(I(s.messages[c].min,r.fullField,r.min))}else if(f&&!o&&l>r.max){n.push(I(s.messages[c].max,r.fullField,r.max))}else if(o&&f&&(l<r.min||l>r.max)){n.push(I(s.messages[c].range,r.fullField,r.min,r.max))}};var ft="enum";var ut=function t(r,e,i,n,s){r[ft]=Array.isArray(r[ft])?r[ft]:[];if(r[ft].indexOf(e)===-1){n.push(I(s.messages[ft],r.fullField,r[ft].join(", ")))}};var lt=function t(r,e,i,n,s){if(r.pattern){if(r.pattern instanceof RegExp){r.pattern.lastIndex=0;if(!r.pattern.test(e)){n.push(I(s.messages.pattern.mismatch,r.fullField,e,r.pattern))}}else if(typeof r.pattern==="string"){var a=new RegExp(r.pattern);if(!a.test(e)){n.push(I(s.messages.pattern.mismatch,r.fullField,e,r.pattern))}}}};var ct={required:tt,whitespace:rt,type:at,range:ot,enum:ut,pattern:lt};var ht=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e,"string")&&!r.required){return i()}ct.required(r,e,n,a,s,"string");if(!q(e,"string")){ct.type(r,e,n,a,s);ct.range(r,e,n,a,s);ct.pattern(r,e,n,a,s);if(r.whitespace===true){ct.whitespace(r,e,n,a,s)}}}i(a)};var dt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s);if(e!==undefined){ct.type(r,e,n,a,s)}}i(a)};var vt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(e===""){e=undefined}if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s);if(e!==undefined){ct.type(r,e,n,a,s);ct.range(r,e,n,a,s)}}i(a)};var mt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s);if(e!==undefined){ct.type(r,e,n,a,s)}}i(a)};var pt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s);if(!q(e)){ct.type(r,e,n,a,s)}}i(a)};var gt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s);if(e!==undefined){ct.type(r,e,n,a,s);ct.range(r,e,n,a,s)}}i(a)};var bt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s);if(e!==undefined){ct.type(r,e,n,a,s);ct.range(r,e,n,a,s)}}i(a)};var yt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if((e===undefined||e===null)&&!r.required){return i()}ct.required(r,e,n,a,s,"array");if(e!==undefined&&e!==null){ct.type(r,e,n,a,s);ct.range(r,e,n,a,s)}}i(a)};var xt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s);if(e!==undefined){ct.type(r,e,n,a,s)}}i(a)};var _t="enum";var wt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s);if(e!==undefined){ct[_t](r,e,n,a,s)}}i(a)};var kt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e,"string")&&!r.required){return i()}ct.required(r,e,n,a,s);if(!q(e,"string")){ct.pattern(r,e,n,a,s)}}i(a)};var Ft=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e,"date")&&!r.required){return i()}ct.required(r,e,n,a,s);if(!q(e,"date")){var f;if(e instanceof Date){f=e}else{f=new Date(e)}ct.type(r,f,n,a,s);if(f){ct.range(r,f.getTime(),n,a,s)}}}i(a)};var jt=function t(r,e,i,n,s){var a=[];var o=Array.isArray(e)?"array":typeof e;ct.required(r,e,n,a,s,o);i(a)};var St=function t(r,e,i,n,s){var a=r.type;var o=[];var f=r.required||!r.required&&n.hasOwnProperty(r.field);if(f){if(q(e,a)&&!r.required){return i()}ct.required(r,e,n,o,s,a);if(!q(e,a)){ct.type(r,e,n,o,s)}}i(o)};var zt=function t(r,e,i,n,s){var a=[];var o=r.required||!r.required&&n.hasOwnProperty(r.field);if(o){if(q(e)&&!r.required){return i()}ct.required(r,e,n,a,s)}i(a)};var Ot={string:ht,method:dt,number:vt,boolean:mt,regexp:pt,integer:gt,float:bt,array:yt,object:xt,enum:wt,pattern:kt,date:Ft,url:St,hex:St,email:St,required:jt,any:zt};function Et(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function t(){var r=JSON.parse(JSON.stringify(this));r.clone=this.clone;return r}}}var At=Et();var Ct=function(){function t(t){this.rules=null;this._messages=At;this.define(t)}var r=t.prototype;r.define=function t(r){var e=this;if(!r){throw new Error("Cannot configure a schema with no rules")}if(typeof r!=="object"||Array.isArray(r)){throw new Error("Rules must be an object")}this.rules={};Object.keys(r).forEach((function(t){var i=r[t];e.rules[t]=Array.isArray(i)?i:[i]}))};r.messages=function t(r){if(r){this._messages=Q(Et(),r)}return this._messages};r.validate=function r(e,i,n){var s=this;if(i===void 0){i={}}if(n===void 0){n=function t(){}}var a=e;var o=i;var f=n;if(typeof o==="function"){f=o;o={}}if(!this.rules||Object.keys(this.rules).length===0){if(f){f(null,a)}return Promise.resolve(a)}function u(t){var r=[];var e={};function i(t){if(Array.isArray(t)){var e;r=(e=r).concat.apply(e,t)}else{r.push(t)}}for(var n=0;n<t.length;n++){i(t[n])}if(!r.length){f(null,a)}else{e=B(r);f(r,e)}}if(o.messages){var l=this.messages();if(l===At){l=Et()}Q(l,o.messages);o.messages=l}else{o.messages=this.messages()}var c={};var h=o.keys||Object.keys(this.rules);h.forEach((function(t){var r=s.rules[t];var i=a[t];r.forEach((function(r){var n=r;if(typeof n.transform==="function"){if(a===e){a=C({},a)}i=a[t]=n.transform(i)}if(typeof n==="function"){n={validator:n}}else{n=C({},n)}n.validator=s.getValidationMethod(n);if(!n.validator){return}n.field=t;n.fullField=n.fullField||t;n.type=s.getType(n);c[t]=c[t]||[];c[t].push({rule:n,value:i,source:a,field:t})}))}));return Z(c,o,(function(r,e){var i=r.rule;var n=(i.type==="object"||i.type==="array")&&(typeof i.fields==="object"||typeof i.defaultField==="object");n=n&&(i.required||!i.required&&r.value);i.field=r.field;function s(t,r){return C({},r,{fullField:i.fullField+"."+t,fullFields:i.fullFields?[].concat(i.fullFields,[t]):[t]})}function f(f){if(f===void 0){f=[]}var u=Array.isArray(f)?f:[f];if(!o.suppressWarning&&u.length){t.warning("async-validator:",u)}if(u.length&&i.message!==undefined){u=[].concat(i.message)}var l=u.map(X(i,a));if(o.first&&l.length){return e(l)}if(!n){e(l)}else{if(i.required&&!r.value){if(i.message!==undefined){l=[].concat(i.message).map(X(i,a))}else if(o.error){l=[o.error(i,I(o.messages.required,i.field))]}return e(l)}var c={};if(i.defaultField){Object.keys(r.value).map((function(t){c[t]=i.defaultField}))}c=C({},c,r.rule.fields);var h={};Object.keys(c).forEach((function(t){var r=c[t];var e=Array.isArray(r)?r:[r];h[t]=e.map(s.bind(null,t))}));var d=new t(h);d.messages(o.messages);if(r.rule.options){r.rule.options.messages=o.messages;r.rule.options.error=o.error}d.validate(r.value,r.rule.options||o,(function(t){var r=[];if(l&&l.length){r.push.apply(r,l)}if(t&&t.length){r.push.apply(r,t)}e(r.length?r:null)}))}}var u;if(i.asyncValidator){u=i.asyncValidator(i,r.value,f,r.source,o)}else if(i.validator){try{u=i.validator(i,r.value,f,r.source,o)}catch(t){console.error==null?void 0:console.error(t);if(!o.suppressValidatorError){setTimeout((function(){throw t}),0)}f(t.message)}if(u===true){f()}else if(u===false){f(typeof i.message==="function"?i.message(i.fullField||i.field):i.message||(i.fullField||i.field)+" fails")}else if(u instanceof Array){f(u)}else if(u instanceof Error){f(u.message)}}if(u&&u.then){u.then((function(){return f()}),(function(t){return f(t)}))}}),(function(t){u(t)}),a)};r.getType=function t(r){if(r.type===undefined&&r.pattern instanceof RegExp){r.type="pattern"}if(typeof r.validator!=="function"&&r.type&&!Ot.hasOwnProperty(r.type)){throw new Error(I("Unknown rule type %s",r.type))}return r.type||"string"};r.getValidationMethod=function t(r){if(typeof r.validator==="function"){return r.validator}var e=Object.keys(r);var i=e.indexOf("message");if(i!==-1){e.splice(i,1)}if(e.length===1&&e[0]==="required"){return Ot.required}return Ot[this.getType(r)]||undefined};return t}();Ct.register=function t(r,e){if(typeof e!=="function"){throw new Error("Cannot register a validator by type, validator is not a function")}Ot[r]=e};Ct.warning=N;Ct.messages=At;Ct.validators=Ot;const Rt='@charset "UTF-8";ul,li{list-style:none;margin:0;padding:0}button{border:none;margin:0;padding:0;width:auto;overflow:visible;background:transparent;color:inherit;font:inherit;line-height:normal;-webkit-font-smoothing:inherit;-moz-osx-font-smoothing:inherit;-webkit-appearance:none}button::-moz-focus-inner{border:0;padding:0}.ks-text-bodyMd{font-size:var(--ks-text-bodyMd-fontSize);line-height:var(--ks-text-bodyMd-lineHeight);font-weight:var(--ks-text-bodyMd-fontWeight);letter-spacing:var(--ks-text-bodyMd-letterSpacing);font-family:var(--ks-text-bodyMd-fontFamily)}@keyframes breathing-opacity{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}.ks-skeleton,.animate-pulse{background-color:var(--ks-color-neutral-surface3);border-radius:var(--ks-border-radius-sm);animation-name:breathing-opacity;animation-duration:2s;animation-timing-function:cubic-bezier(0.455, 0, 0.55, 1);animation-fill-mode:forwards;animation-iteration-count:infinite}.ks-card-section{margin-bottom:var(--ks-spacing-400);font-size:var(--ks-text-titleMd-fontSize);line-height:var(--ks-text-titleMd-lineHeight);font-weight:var(--ks-text-titleMd-fontWeight);letter-spacing:var(--ks-text-titleMd-letterSpacing);font-family:var(--ks-text-titleMd-fontFamily)}*,:host{box-sizing:border-box}:host{--ks-form-list-height-xs:26px;--ks-form-list-height-sm:30px;--ks-form-list-height-md:34px;--ks-form-list-height-lg:38px;--ks-form-list-height-xl:42px;--ks-form-list-height-xxl:46px;--ks-form-list-fontSize-xs:12px;--ks-form-list-fontSize-sm:12px;--ks-form-list-fontSize-md:14px;--ks-form-list-fontSize-lg:14px;--ks-form-list-fontSize-xl:16px;--ks-form-list-fontSize-xxl:16px}.form-list{display:flex;gap:var(--ks-spacing-200);flex-direction:column}.form-list__label{display:flex;box-sizing:border-box;gap:8px;position:relative}.form-list__label--optional{color:var(--ks-color-neutral-lowOnSurface)}.form-list__label--empty{display:none}.form-list__control{flex:1 1 auto}.form-list__control__message{min-height:20px;padding:4px 0 8px 0;box-sizing:content-box}.form-list__control__message__text{display:block;color:var(--ks-color-neutral-onSurface)}.form-list__control__message__text--warning{color:var(--ks-color-warning-onSurface)}.form-list__control__message__text--error{color:var(--ks-color-error-onSurface)}.form-list__control__message__icon{display:inline-flex;justify-content:center;align-items:center;width:16px;height:16px;border-radius:var(--ks-border-radius-full);color:var(--ks-color-neutral-onFillLow);background-color:var(--ks-color-neutral-fillLow);margin-right:var(--ks-spacing-100)}.form-list__control__message__icon--warning{color:var(--ks-color-neutral-onFillLow);background-color:var(--ks-color-neutral-fillLow)}.form-list__control__message__icon--error{color:var(--ks-color-error-onFillLow);background-color:var(--ks-color-error-fillLow)}.form-list__control__message__icon--success{color:var(--ks-color-success-onFillLow);background-color:var(--ks-color-success-fillLow)}.form-list--size-md .form-list__label{font-size:var(--ks-form-list-fontSize-md)}.form-list--size-md .form-list__control__message{font-size:calc(var(--ks-form-list-fontSize-md) - 2px);min-height:calc(var(--ks-form-list-height-md) - 14px);padding:4px 0 8px 0}.form-list--size-lg .form-list__label{font-size:var(--ks-form-list-fontSize-lg)}.form-list--size-lg .form-list__control__message{font-size:calc(var(--ks-form-list-fontSize-lg) - 2px);min-height:calc(var(--ks-form-list-height-lg) - 14px);padding:4px 0 8px 0}';var Vt=undefined&&undefined.__decorate||function(t,r,e,i){var n=arguments.length,s=n<3?r:i===null?i=Object.getOwnPropertyDescriptor(r,e):i,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(t,r,e,i);else for(var o=t.length-1;o>=0;o--)if(a=t[o])s=(n<3?a(s):n>3?a(r,e,s):a(r,e))||s;return n>3&&s&&Object.defineProperty(r,e,s),s};const Mt="form";const Dt=()=>{};const Pt=class{constructor(e){t(this,e);this.ksValueChange=r(this,"ksValueChange",1);this.ksFinish=r(this,"ksFinish",1);this.ksFinishFailed=r(this,"ksFinishFailed",1);this["ks-name"]="ks-form";this.context={_prefixPath:[],disabled:false,value:{},validationStates:{[x]:null},callbacks:{onValueChange:(t,r,e)=>{this._onValueChangeAlreadyCalled=true;const i=c(this.context.value,r,t);this.context={...this.context,value:i};this._validateField(e||[],{validateTrigger:"change"}).catch(Dt);this.ksValueChange?.emit(this.context.value);queueMicrotask((()=>this._notifyWatch(e||[])))},onBlur:(t=[])=>{if(this.validateTrigger==="blur"||Array.isArray(this.validateTrigger)&&this.validateTrigger.includes("blur")){this._validateField(t,{validateTrigger:"blur"}).catch(Dt)}},onValidation:async(t=[])=>{await this.validateField(t).catch(Dt)},_onValidationStatesChange:(t,r=[])=>{const e=c(this.context.validationStates,r,t);this.context={...this.context,validationStates:e}},onResetValidation:async(t=[])=>{await this.resetValidate(t)},_onComponentConnect:(t,r=[])=>{this._updateInstanceMap(t,r);this._initialValuesFromInstance=c(this._initialValuesFromInstance,r,t.initialValue)},_onComponentDisconnect:(t,r=[])=>{if(Object.is(t,y(this._instanceMap,[...r,_]))){A(this._instanceMap,[...r,_]);A(this._initialValuesFromInstance,r)}},_onPathChange:(t,r,e)=>{if(Object.is(t,y(this._instanceMap,[...r,_]))){A(this._instanceMap,[...r,_]);A(this._initialValuesFromInstance,r)}this._updateInstanceMap(t,e);this._initialValuesFromInstance=c(this._initialValuesFromInstance,e,t.initialValue)},_registerWatch:(t,r,e)=>{if(typeof t==="string"){t=l(t)}return this._registerWatch(t,r,e)}}};this.initialValues={};this._initialValuesFromInstance={};this.labelAlign="right";this.disabled=false;this.validateTrigger="change";this.first=false;this._instanceMap={[_]:null};this._watchMap=new Map;this.getValidationDescriptor=(t,r)=>{const{validateTrigger:e=true,recursive:i=false}=r;const n=i?t.reduce(((t,r)=>{if(r.length){t.push(...h(y(this._instanceMap,r),new RegExp(_)).map((t=>[...r,...t])))}else{t.push(...h(this._instanceMap,new RegExp(_)))}return t}),[]):t;return n.reduce((({values:t,descriptors:r},i)=>{const n=y(this._instanceMap,[...i,_]);if(n){if(e===true||(Array.isArray(n.validateTrigger)?n.validateTrigger.includes(e):n.validateTrigger===e)){return{values:{...t,[i.join(".")]:y(this.context.value,i)},descriptors:{...r,[i.join(".")]:n._collectRules(e)||[]}}}}return{values:t,descriptors:r}}),{values:{},descriptors:{}})};this._currentValidationId=-1;this._onValueChangeAlreadyCalled=false;this._scrollToField=t=>{const r=this.getFieldInstanceSync(t);r?.scrollIntoView({behavior:"smooth"})};this._setFieldValue=(t,r)=>{this.setFieldValueSync(t,r)};this._setFields=t=>{t.forEach((t=>{this.setFieldValueSync(t.name,t.value)}))};this._setFieldsValue=t=>{Object.keys(t).forEach((r=>{this.setFieldValueSync(r,t[r])}))};this._submit=()=>{this.submitSync()};this._validateFields=()=>this.validateFields();this.useWatch=(t,r)=>{this._registerWatch(l(t),r)}}watchContextPropsChange(){this.context={...this.context,disabled:this.disabled,labelWidth:this.labelWidth,labelAlign:this.labelAlign}}watchInitialValuesFromInstanceChange(){if(!this._onValueChangeAlreadyCalled){this._resetFields()}}componentWillLoad(){this.context={...this.context,disabled:this.disabled,labelWidth:this.labelWidth,labelAlign:this.labelAlign,value:this.initialValues}}componentDidLoad(){this._disposeSubmitBtnsClick=d(v(this.el),this.submit.bind(this));this._disposeResetBtnsClick=d(m(this.el),(()=>this.resetFields()))}disconnectedCallback(){this._disposeSubmitBtnsClick?.();this._disposeResetBtnsClick?.()}_updateInstanceMap(t,r){if(t["ks-name"]==="ks-form-item"){E(this._instanceMap,[...r,_],t)}else if(t["ks-name"]==="ks-form-list"){if(!y(this._instanceMap,r)){E(this._instanceMap,r,[])}E(this._instanceMap,[...r,_],t)}}_registerWatch(t,r,e=true){e&&r(y(this.context.value,t));const i=t.join(".");if(!this._watchMap.has(i)){this._watchMap.set(i,[])}this._watchMap.get(i)?.push(r);return()=>{this._watchMap.set(i,this._watchMap.get(i)?.filter((t=>t!==r))||[])}}_notifyWatch(t){const r=t.join(".");this._watchMap.forEach(((t,e)=>{if(e.startsWith(r)){t.forEach((t=>t(y(this.context.value,e))))}}))}async submit(){return this.submitSync()}submitSync(){this._validateField([],{validateTrigger:true,recursive:true}).then((t=>{this.ksFinish?.emit(t)})).catch((t=>{this.ksFinishFailed?.emit(t)}))}async getFieldsValue(t){return this.getFieldsValueSync(t)}getFieldsValueSync(t){if(!t){return this.context.value}else{return t.map((t=>y(this.context.value,t)))}}async getFieldValue(t){return this.getFieldValueSync(t)}getFieldValueSync(t){return y(this.context.value,t)}async setFieldsValue(t){this.context.callbacks.onValueChange(t,[],[])}async setFieldValue(t,r){this.setFieldValueSync(t,r)}setFieldValueSync(t,r){const e=t instanceof Array?t:l(t);this.context.callbacks.onValueChange(r,e,e)}async getFieldInstance(t=[]){return this.getFieldInstanceSync(t)}getFieldInstanceSync(t=[]){const r=t instanceof Array?t:l(t);return y(this._instanceMap,[...r,_])}_getFieldError(t){const r=y(this.context.validationStates,[...t,x]);return r.filter((t=>t.status==="error")).map((t=>t.message))}async getFieldError(t){return this.getFieldErrorSync(t)}getFieldErrorSync(t){const r=typeof t==="string"?l(t):t;return this._getFieldError(r)}async getFieldsError(t){return this.getFieldsErrorSync(t)}getFieldsErrorSync(t){return t.map((t=>{if(typeof t==="string"){t=l(t)}return{name:t,errors:this._getFieldError(t)}}))}async validateFields(){return await this._validateField([],{validateTrigger:true,recursive:true})}async validateField(t=[],r){if(typeof t==="string"){t=l(t)}return await this._validateField(t,r||{})}async _validateField(t,r){const{validateTrigger:e=true,recursive:i=false}=r;const n=++this._currentValidationId;const{values:s,descriptors:a}=this.getValidationDescriptor([t],{validateTrigger:e,recursive:i});if(!Object.keys(a).length){return y(this.context.value,t,this.context.value)}const o=new Ct(a);try{await o.validate(s,{first:this.first,firstFields:this.firstFields});if(this._currentValidationId===n){let r=this.context.validationStates;Object.keys(s).forEach((t=>{const e=l(t);const i=y(this._instanceMap,[...e,_]);if(i["ks-name"]==="ks-form-list"&&!y(r,e)){const t=[];t[x]=[{status:"success"}];r=c(r,e,t)}else{r=c(r,[...e,x],[{status:"success"}])}}));this.context={...this.context,validationStates:r};return y(this.context.value,t,this.context.value)}}catch(r){const{errors:e}=r;if(!e?.length){throw r}if(this._currentValidationId===n){let r=this.context.validationStates;let i=false;const n=[];const s=e.reduce(((t,{field:r,message:e,rule:i})=>({...t,[r]:[...t[r]||[],{message:e,rule:i}]})),{});Object.entries(s).forEach((([t,e])=>{const s=e.map((({message:t,rule:r})=>{const e=r.warningOnly;if(!e){i=true}const n={status:e?"warning":"error",message:t,cta:r.messageCta};return n}));const a=l(t);const o=y(this._instanceMap,[...a,_]);if(o["ks-name"]==="ks-form-list"&&!y(r,a)){const t=[];t[x]=s;r=c(r,a,t)}else{r=c(r,[...a,x],s)}n.push({name:t,errors:s.filter((t=>t.status==="error")).map((t=>t.message)),warnings:s.filter((t=>t.status==="warning")).map((t=>t.message))})}));this.context={...this.context,validationStates:r};const a=y(this.context.value,t,this.context.value);if(i){return Promise.reject({errorFields:n,values:a})}else{return a}}}}async resetFields(t=[]){this._resetFields(t)}_resetFields(t=[]){const r=e({},this._initialValuesFromInstance,this.initialValues);if(!t.length){this.context={...this.context,value:r};this.resetValidate()}else{let{value:e}=this.context;t.forEach((t=>{e=c(e,t,y(r,t));this.resetValidate(t)}));this.context={...this.context,value:e}}this.ksValueChange?.emit(this.context.value);queueMicrotask((()=>this._notifyWatch([])))}async scrollToField(t){const r=await this.getFieldInstance(t);r.scrollIntoView({behavior:"smooth"})}async scrollToFirstError(){const t=this.el.querySelectorAll("[ks-form-item]");for(let r=0;r<t.length;r++){const e=t[r];if(e["ks-name"]==="ks-form-item"&&e._validateStatus==="error"){e.scrollIntoView({behavior:"smooth"});return}}}async resetValidate(t=[]){if(!t.length){this.context={...this.context,validationStates:{[x]:null}};return}let r=this.context.validationStates;t=typeof t==="string"?l(t):t;const e=y(this._instanceMap,[...t,_]);if(e["ks-name"]==="ks-form-list"&&!y(r,t)){const e=[];e[x]=null;r=c(r,t,e)}else{r=c(r,[...t,x],null)}this.context={...this.context,validationStates:r}}render(){return i(n,{key:"88b1a493d7a5a1449535d20c90cf8c009d06ddbd",dir:f(),"ks-form":true},i("form",{key:"ba3ad8bd2aed8738a7e2529fb71cabd4968b387d",dir:f(),class:u(Mt),part:"self"},i("slot",{key:"ddd53a0e25fdc9d140e637298e7e1b4ac0684aa0"})))}get el(){return s(this)}static get watchers(){return{disabled:["watchContextPropsChange"],labelWidth:["watchContextPropsChange"],labelAlign:["watchContextPropsChange"],_initialValuesFromInstance:["watchInitialValuesFromInstanceChange"]}}};Vt([a({context:o,callback:t=>{t?.dispatchEvent?.(new CustomEvent("context-change",{detail:t}))}})],Pt.prototype,"context",void 0);Pt.style=Rt;export{Pt as ks_form};