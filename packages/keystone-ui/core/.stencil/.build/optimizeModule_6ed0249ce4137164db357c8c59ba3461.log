import{r as a,c as t,l as r,h as i,F as o,H as e,a as s}from"./p-BVbYP5UG.js";import{c as l}from"./p-BLeWSNPN.js";import{j as n,k as d,d as c,t as h}from"./p-B9Bv72kO.js";import{u}from"./p-CZoCRgNL.js";import"@oddbird/popover-polyfill";import"./p-B85MJLTf.js";import"./p-BpTTFEEs.js";const p='@charset "UTF-8";ul,li{list-style:none;margin:0;padding:0}button{border:none;margin:0;padding:0;width:auto;overflow:visible;background:transparent;color:inherit;font:inherit;line-height:normal;-webkit-font-smoothing:inherit;-moz-osx-font-smoothing:inherit;-webkit-appearance:none}button::-moz-focus-inner{border:0;padding:0}.ks-text-bodyMd{font-size:var(--ks-text-bodyMd-fontSize);line-height:var(--ks-text-bodyMd-lineHeight);font-weight:var(--ks-text-bodyMd-fontWeight);letter-spacing:var(--ks-text-bodyMd-letterSpacing);font-family:var(--ks-text-bodyMd-fontFamily)}@keyframes breathing-opacity{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}.ks-skeleton,.animate-pulse{background-color:var(--ks-color-neutral-surface3);border-radius:var(--ks-border-radius-sm);animation-name:breathing-opacity;animation-duration:2s;animation-timing-function:cubic-bezier(0.455, 0, 0.55, 1);animation-fill-mode:forwards;animation-iteration-count:infinite}.ks-card-section{margin-bottom:var(--ks-spacing-400);font-size:var(--ks-text-titleMd-fontSize);line-height:var(--ks-text-titleMd-lineHeight);font-weight:var(--ks-text-titleMd-fontWeight);letter-spacing:var(--ks-text-titleMd-letterSpacing);font-family:var(--ks-text-titleMd-fontFamily)}*,:host{box-sizing:border-box}:host{display:inline-flex;width:118px;height:118px}.upload-avatar{width:118px;height:118px;position:relative;border-radius:var(--ks-border-radius-md);border:1px dashed var(--ks-color-neutral-fillLow);display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:var(--ks-text-bodySm-fontSize);background-color:var(--ks-ref-color-white);cursor:pointer}.upload-avatar.upload-avatar--plain{color:var(--ks-color-neutral-onSurface)}.upload-avatar.upload-avatar--disabled{cursor:not-allowed;background-color:var(--ks-color-neutral-surface2Disabled);color:var(--ks-color-neutral-onSurfaceDisabled)}.upload-avatar:not(.upload-avatar--disabled):hover{background-color:var(--ks-color-neutral-surfaceHover);border-color:var(--ks-color-neutral-fillLowHover)}.upload-avatar:not(.upload-avatar--disabled):hover.upload-avatar--plain{color:var(--ks-color-neutral-onSurfaceHover)}.upload-avatar:not(.upload-avatar--disabled):active{background-color:var(--ks-color-neutral-surfaceActive);border-color:var(--ks-color-neutral-fillLowActive)}.upload-avatar:not(.upload-avatar--disabled):active.upload-avatar--plain{color:var(--ks-color-neutral-onSurfaceActive)}.upload-avatar--highlight:not(.upload-avatar--disabled){border-color:var(--ks-color-primary-fillLow);background-color:var(--ks-color-primary-surface2)}.upload-avatar--highlight:not(.upload-avatar--disabled).upload-avatar--plain{color:var(--ks-color-neutral-onSurface)}.upload-avatar--error:not(.upload-avatar--disabled){border-color:var(--ks-color-error-fill);background-color:var(--ks-color-error-surface2)}.upload-avatar--error:not(.upload-avatar--highlight){border-color:var(--ks-color-error-fill);background-color:var(--ks-color-error-surface2)}.upload-avatar__picture{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;display:flex;align-items:center;justify-content:center;background-color:var(--ks-color-neutral-surface)}.upload-avatar__picture>img{width:100%;height:auto}.upload-avatar__picture>img.upload-avatar__picture--vertical{width:auto;height:100%}.upload-avatar--progressContainer{width:100px;height:40px;margin-top:35px}';const f="upload-avatar";const v=class{constructor(o){a(this,o);this.ksChange=t(this,"ksChange",1);this.ksError=t(this,"ksError",1);this["ks-name"]="ks-upload-avatar";this.accept=".png,.jpg,.svg,.gif";this.name="file";this.disabled=false;this.method="post";this.fileList=[];this.defaultFileList=[];this.showMessage=false;this.message="";this.description="";this.showUploadList=false;this.previewUrl="";this.highlight=false;this.isError=false;this.imgInfo={width:0,height:0};this.handleChange=async a=>{if(this.disabled)return;const{detail:t}=a;const{error:i}=t;this.highlight=false;if(i){r.error(i);this.isError=true;this.ksError.emit(a.detail);return}this.isError=false;if(this.file?.uid!==a.detail.file.uid){this.previewUrl=""}this.file=a.detail.file;if(this.file&&!this.previewUrl){this.previewUrl=await n(this.file.originFileObj);this.imgInfo=await d(this.previewUrl)}if(a.detail.file.status==="removed"){this.file=null;this.previewUrl=""}this.ksChange.emit?.(a.detail)};this.handleDelete=a=>{a.stopPropagation();this.uploadEl.handleRemove(this.file)};this.renderState=()=>{const{percent:a=10,status:t}=this.file||{};if(t==="uploading"){return i("div",{class:`${f}--progressContainer`},i("ks-progress",{size:"sm",percent:a,showLabel:false}))}if(t==="done"){return i("div",{class:l(`${f}__action`)},i("ks-icon-edit",null),i("ks-icon-filled-close",{class:`${f}__action-close`,onClick:this.handleDelete,"data-testid":"ks-upload-image-index-eKqsJe"}))}return null}}handleDragOver(a){a.preventDefault();if(this.disabled)return;this.highlight=true}handleDragLeave(){this.highlight=false}render(){const{status:a}=this.file||{};return i(e,{key:"239b5856d55ccdd9ef29fb959f58ff4e84972c87",dir:c(),"ks-upload-avatar":true},i("ks-upload",{key:"3cb4bbcfe18dbbd897cc45c880eeafa4d308648b",dir:c(),ref:a=>this.uploadEl=a,accept:this.accept,action:this.action,data:this.data,name:this.name,disabled:this.disabled,multiple:false,headers:this.headers,method:this.method,fileList:this.fileList,defaultFileList:this.defaultFileList,showUploadList:this.showUploadList,beforeRemove:this.beforeRemove,beforeUpload:this.beforeUpload,onKsChange:this.handleChange,showMessage:this.showMessage,message:this.message,description:this.description,"data-testid":"ks-upload-image-index-fbq3jt"},i("div",{key:"4240c0424c9a98c7d304a2a751752a7163e54f65",onDragEnter:a=>this.handleDragOver(a),onDragOver:a=>this.handleDragOver(a),onDragLeave:()=>this.handleDragLeave(),class:l(f,`${f}--plain`,{[`${f}--disabled`]:this.disabled},this.isError?`${f}--error`:"",this.highlight?`${f}--highlight`:""),"data-testid":"ks-upload-image-index-fAyCCs"},a!=="uploading"&&i(o,{key:"005f934eb83c6a39fd29881a612d65734c5bd3bc"},i("ks-icon-plus",{key:"875a58a41dcff95dff0337bfe63cc80ccfb197f5"}),i("span",{key:"348ff3555d7ae41675da9fb1a0000f6f8643aa77"},h(u.button))),this.previewUrl&&i("div",{key:"d3e06df0b5dff490f11186edcd3a8fc88dafb52c",class:`${f}__picture`},i("img",{key:"e77d2ddf9c02839803112e2945227c70491a7061",src:this.previewUrl,class:l({[`${f}__picture--vertical`]:this.imgInfo.width<this.imgInfo.height}),alt:""})),this.renderState())))}get el(){return s(this)}};v.style=p;export{v as ks_upload_avatar};