import{r as t,t as e,h as i,H as s,a}from"./p-BVbYP5UG.js";import{c as o}from"./p-BLeWSNPN.js";import{E as c}from"./p-ClUjZ4dQ.js";import{s as n,i as r,t as l}from"./p-B9Bv72kO.js";import{s as d,c as h}from"./p-CZoCRgNL.js";import{t as m}from"./p-C2yhXC4K.js";import"@oddbird/popover-polyfill";import"./p-B85MJLTf.js";import"./p-BpTTFEEs.js";import"./p-B0FO8VRg.js";import"./p-D53F0nW8.js";const u='@charset "UTF-8";ul,li{list-style:none;margin:0;padding:0}button{border:none;margin:0;padding:0;width:auto;overflow:visible;background:transparent;color:inherit;font:inherit;line-height:normal;-webkit-font-smoothing:inherit;-moz-osx-font-smoothing:inherit;-webkit-appearance:none}button::-moz-focus-inner{border:0;padding:0}.ks-text-bodyMd{font-size:var(--ks-text-bodyMd-fontSize);line-height:var(--ks-text-bodyMd-lineHeight);font-weight:var(--ks-text-bodyMd-fontWeight);letter-spacing:var(--ks-text-bodyMd-letterSpacing);font-family:var(--ks-text-bodyMd-fontFamily)}@keyframes breathing-opacity{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}.ks-skeleton,.animate-pulse{background-color:var(--ks-color-neutral-surface3);border-radius:var(--ks-border-radius-sm);animation-name:breathing-opacity;animation-duration:2s;animation-timing-function:cubic-bezier(0.455, 0, 0.55, 1);animation-fill-mode:forwards;animation-iteration-count:infinite}.ks-card-section{margin-bottom:var(--ks-spacing-400);font-size:var(--ks-text-titleMd-fontSize);line-height:var(--ks-text-titleMd-lineHeight);font-weight:var(--ks-text-titleMd-fontWeight);letter-spacing:var(--ks-text-titleMd-letterSpacing);font-family:var(--ks-text-titleMd-fontFamily)}*,:host{box-sizing:border-box}.cascader-columns{white-space:nowrap;overflow-x:auto;scrollbar-width:none;display:flex;align-items:stretch;flex-direction:row;min-height:40px}.cascader-columns__column{box-sizing:border-box;display:inline-block;vertical-align:top;overflow-y:auto;padding:0 var(--ks-spacing-100);scrollbar-width:none}.cascader-columns__column:not(:nth-last-child(1)){border-right:1px solid var(--ks-color-neutral-fillLow)}.cascader-columns__column-wrapper{height:100%}.cascader-columns__column__item{padding:var(--ks-spacing-200);display:flex;justify-content:space-between;align-items:center;color:var(--ks-color-neutral-highOnSurface);border-radius:var(--ks-border-radius-md);column-gap:var(--ks-spacing-200);cursor:pointer;transition-property:all;transition-duration:100ms;transition-timing-function:var(--ks-transition-easing-standardOut)}.cascader-columns__column__item__left__multiple{display:flex;flex:1;width:calc(100% - 24px)}.cascader-columns__column__item__left>*{vertical-align:middle}.cascader-columns__column__item__left--fulllabel>[ks-checkbox]{width:calc(100% - 12px)}.cascader-columns__column__item:not(.cascader-columns__column__item--disabled,.cascader-columns__column__item--active,.cascader-columns__column__item--selected):hover{background-color:var(--ks-color-neutral-surfaceHover)}.cascader-columns__column__item:not(.cascader-columns__column__item--disabled,.cascader-columns__column__item--active,.cascader-columns__column__item--selected):active{background-color:var(--ks-color-neutral-surfaceActive)}.cascader-columns__column__item--active{background-color:var(--ks-color-neutral-surfaceActive)}.cascader-columns__column__item--selected{background-color:var(--ks-color-primary-surface2)}.cascader-columns__column__item--selected:not(.cascader-columns__column__item--disabled):hover{background-color:var(--ks-color-primary-surface2Hover)}.cascader-columns__column__item--selected:not(.cascader-columns__column__item--disabled):active{background-color:var(--ks-color-primary-surface2Active)}.cascader-columns__column__item--selected:not(.cascader-columns__column__item--active) .cascader-columns__column__item__nexticon{color:initial;font-weight:bold}.cascader-columns__column__item--disabled{color:var(--ks-color-neutral-onSurfaceDisabled);cursor:not-allowed}.cascader-columns__column__item--disabled.cascader-columns__column__item--selected,.cascader-columns__column__item--disabled.cascader-columns__column__item--active{background-color:var(--ks-color-primary-surface1)}.cascader-columns__column__item--disabled .cascader-columns__column__item--count{background-color:var(--ks-color-neutral-fillDisabled);color:var(--ks-color-primary-onFillDisabled)}.cascader-columns__column__item--count{display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;border-radius:8px;min-width:16px;height:16px;line-height:16px;color:var(--ks-ref-color-white);padding:0 var(--ks-spacing-100);font-size:var(--ks-text-labelMd-fontSize);line-height:var(--ks-text-labelMd-lineHeight);font-weight:var(--ks-text-labelMd-fontWeight);letter-spacing:var(--ks-text-labelMd-letterSpacing);font-family:var(--ks-text-labelMd-fontFamily);font-variant-numeric:lining-nums tabular-nums;background-color:var(--ks-color-neutral-fill)}.cascader-columns__column__loadmore{display:flex;justify-content:center;align-items:center;gap:10px;height:40px;color:var(--ks-color-primary-fill)}.cascader-columns__column__loadmore__loading{color:var(--ks-color-primary-fill)}.cascader-columns__column__loadmore__toload{cursor:pointer}.cascader-columns__column__loading{color:var(--ks-color-primary-fill);display:flex;width:100%;height:100%;justify-content:center;align-items:center}.cascader-columns__column::-webkit-scrollbar{display:none}.cascader-columns__end{display:inline-block;width:0;height:1px}.cascader-columns::-webkit-scrollbar{display:none}[dir=rtl] .cascader-columns__column:not(:nth-last-child(1)){border-right:none}[dir=rtl] .cascader-columns__column:not(:nth-child(1)){border-right:1px solid var(--ks-color-neutral-fillLow)}';const _="cascader-columns";const f=40;const p=2;const b=5;const g=class{constructor(e){t(this,e);this["ks-name"]="ks-cascader-columns";this.valueKey="value";this.labelKey="label";this.childrenKey="children";this.disabledKey="disabled";this.needLoadKey="needLoad";this.showAllKey="showAll";this.maxViewColumns=3;this.multiple=false;this.columnList=[];this.columnLoadingMap={};this.isColumnAdded=false;this.loadMoreIngs={};this.scrollTopMap={};this.viewportHeight=0;this.startIndexMap={};this.endIndexMap={}}async initColumnList(t,e,i){const s={...this.treeMap.createRootNode(),[this.childrenKey]:i};this.columnList=[];const a=t;if(a!==undefined&&a!==null&&a!==""){let t=e[a];if(t===undefined){this.columnList.unshift(s)}else{while(t!==undefined){this.columnList.unshift(t);t=t[c.PARENT_KEY]??undefined}e[a][this.childrenKey]&&this.columnList.push(e[a][this.childrenKey]);this.columnList.pop()}}else{this.columnList.unshift(s)}}async updateColumnList(t){if(this.columnList[t[c.FLOOR_KEY]+1]===t){return}if(this.needHasChildren(t)){const e=t[c.FLOOR_KEY];for(let t=e;t<this.columnList.length-1;t++){this.scrollTopMap[t]=0}this.columnList?.splice(t[c.FLOOR_KEY]+1,this.columnList?.length,t)}else{this.scrollTopMap[t[c.FLOOR_KEY]]=0;this.columnList?.splice(t[c.FLOOR_KEY]+1,this.columnList?.length)}this.columnList.forEach((t=>this.updateVisibleRange(t)));e(this.el);this.isColumnAdded=true}updateDatasourceMap(t,e){if(!t?.length){return}this.datasourceMap=this.treeMap.insertNode(t,e);this.updateVisibleRange(e)}activeItem(t){this.updateColumnList(t);if(t[this.needLoadKey]){this.loadSubHandler(t)}}multipleChangeItem(t,e){e?this.addSelectedFullValue?.(t):this.removeSelectedFullValue?.(t)}multipleActiveItem(t){this.activeItem(t)}singleActiveItem(t,e){this.activeItem(t);!e&&(t.selectable||t.selectable===undefined)&&this.updateSelectedFullValue?.(t)}columnScrollHandler(t,e){if(!t.target){return}const{scrollTop:i,offsetHeight:s,scrollHeight:a}=t.target;if(i+s>=a&&this.loadMore){this.loadMoreHandler(e)}this.scrollTopMap[e[c.FLOOR_KEY]]=i;this.updateVisibleRange(e)}updateVisibleRange(t){if(!this.winEl){return}const i=t[c.FLOOR_KEY];const s=this.scrollTopMap[i]||0;const a=Math.floor(s/(f+p));const o=Math.ceil((s+this.viewportHeight)/(f+p));this.startIndexMap[i]=Math.max(0,a-b);this.endIndexMap[i]=Math.min(t[this.childrenKey]?.length||0,o+b);e(this.el)}async loadSubHandler(t){try{const i=await(this.load?.(t));this.updateDatasourceMap(i,t);t[this.needLoadKey]=false;this.multiple?this.rectifySelectValue?.():e(this.el)}catch(t){this.columnList.pop();e(this.el)}}async loadMoreHandler(t){const i=t[c.FLOOR_KEY];if(this.loadMoreIngs[i]){return}try{this.loadMoreIngs[i]=true;e(this.el);const s=await this.loadMore(t[c.FLOOR_KEY]>this.treeMap.rootFloor?t:undefined);this.updateDatasourceMap(s,t);this.multiple?this.rectifySelectValue?.():e(this.el)}catch(t){}finally{this.loadMoreIngs[i]=false;e(this.el)}}async updateScrollIntoView(){const{scrollWidth:t,clientWidth:e}=this.winEl;if(t>e){n(this.winEl,{left:!r()?t-e:e-t})}Object.keys(this.scrollTopMap).forEach((t=>{const e=Number(t);const i=this.scrollTopMap[e];const s=this.winEl.children[e+1];if(s){s.scrollTop=i}}))}componentDidUpdate(){this.isColumnAdded&&this.updateScrollIntoView();this.isColumnAdded=false}componentDidLoad(){this.viewportHeight=this.winEl.scrollHeight;this.resizeObserver=new ResizeObserver((t=>{for(const e of t){if(e.target===this.winEl){this.viewportHeight=e.contentRect.height;this.columnList.forEach((t=>this.updateVisibleRange(t)))}}}));this.resizeObserver.observe(this.winEl)}needHasChildren(t){return t[this.needLoadKey]||t[this.childrenKey]?.length>0}renderItem(t,e,s){const a=`${_}__column__item`;const n=this.columnList.some((e=>e[c.FULL_VALUE_KEY]===t[c.FULL_VALUE_KEY]));const r=t[c.FULL_PATH_KEY].some((t=>this.datasourceMap[t]?.[this.disabledKey]));const l=t[this.disabledKey]||this.disabled||r;if(this.multiple&&(t.selectable||t.selectable===undefined)){const{selected:c,isIndeterminate:r,count:d}=this.treeMap.isSelectedInMultipleMode(t,this.selectedFullValue,this.checkStrategy);return i("div",{class:o(`${a}`,{[`${a}--selected`]:c||r,[`${a}--active`]:n,[`${a}--disabled`]:l}),style:{position:"absolute",top:`${(s+e)*(f+p)}px`,left:"0",width:"100%",height:`${f}px`},onClick:()=>{this.multipleActiveItem(t)},part:"item",key:t[this.valueKey],"data-testid":`columns-index-9GZZbr-${t[this.valueKey]}`},i("div",{class:o(`${a}__left`,{[`${a}__left--fulllabel`]:!this.needHasChildren(t),[`${a}__left__multiple`]:this.multiple}),part:"item-left"},i("ks-checkbox",{checked:c,indeterminate:r,disabled:l,onClick:t=>{t.stopPropagation()},onKsChange:({detail:e})=>{this.multipleChangeItem(t,e)},"data-testid":"columns-index-35z2cm"},!this.needHasChildren(t)?i("ks-text",{variant:"bodySm",ellipsis:true},t[this.labelKey]):undefined),this.needHasChildren(t)?i("ks-text",{variant:"bodySm",ellipsis:true},t[this.labelKey]):undefined),this.needHasChildren(t)&&(c||r)&&d>0&&i("sup",{class:`${a}--count`},d),this.needHasChildren(t)?i("ks-icon-chevron-right",{size:"14",class:`${a}__nexticon`}):undefined)}else{const r=this.treeMap.isSelectedInSingleMode(t,this.selectedFullValue);let d;if(typeof this.selectedFullValue==="string"||typeof this.selectedFullValue==="number"){d=this.datasourceMap[this.selectedFullValue]?.[c.FULL_PATH_KEY]?.includes(t[c.FULL_VALUE_KEY])}else if(this.selectedFullValue instanceof Set){d=false;this.selectedFullValue.forEach((e=>{if(this.datasourceMap[e]?.[c.FULL_PATH_KEY]?.includes(t[c.FULL_VALUE_KEY])){d=true}}))}return i("div",{class:o(`${a}`,{[`${a}--selected`]:r||d,[`${a}--active`]:n,[`${a}--disabled`]:l}),onClick:()=>{this.singleActiveItem(t,l)},style:{position:"absolute",top:`${(s+e)*(f+p)}px`,left:"0",width:"100%",height:`${f}px`},key:t[this.valueKey],part:"item","data-testid":`columns-index-vUccWm-${t[this.valueKey]}`},i("ks-text",{variant:"bodySm",ellipsis:true,class:o(`${a}__left`),part:"item-left"},t[this.labelKey]),this.needHasChildren(t)?i("ks-icon-chevron-right",{size:"14",class:`${a}__nexticon`}):undefined)}}renderSelectAllInColumn(t){const e=`${_}__column__item`;if(this.multiple&&(this.showAll||t[this.showAllKey])){const{selected:s,isIndeterminate:a}=this.treeMap.isSelectedInMultipleMode(t,this.selectedFullValue,this.checkStrategy);return i("div",{class:o(`${e}`,`${e}__left--fulllabel`)},i("ks-checkbox",{checked:s,indeterminate:a,onKsChange:({detail:e})=>{this.multipleChangeItem(t,e)},"data-testid":"columns-index-1ngUug"},l(d.selectAll)))}}renderColumn(t){const e=t[c.FLOOR_KEY];const s=`${_}__column`;if(t[this.childrenKey]?.length){return[this.renderSelectAllInColumn(t),i("div",{style:{height:`${f*t[this.childrenKey].length}px`,position:"relative"}},[...t[this.childrenKey].slice(this.startIndexMap[e]||0,this.endIndexMap[e]||0).map(((t,i)=>this.renderItem(t,i,this.startIndexMap[e])))]),this.loadMore?i("div",{class:o(`${s}__loadmore`)},this.loadMoreIngs[e]?i("ks-icon-loading",{size:"14",class:o(`${s}__loadmore__loading`)}):i("span",{class:o(`${s}__loadmore__toload`),onClick:()=>{this.loadMoreHandler(t)},"data-testid":"columns-index-1aatpR"},"more ",i("ks-icon-chevron-down",{size:"14"}))):undefined]}else{if(t[this.needLoadKey]){return i("div",{class:o(`${s}__loading`)},i("ks-icon-loading",{size:"14"}))}else{return i("ks-empty-states",{title:l(h.empty)})}}}render(){const t=`max(calc(${this.displayWidth} / ${this.columnList?.length||1}), ${this.columnMinWidth})`;const e={width:t};return i(s,{key:"ad836bd06cb6455e2195dc071aa047a4ce29735f"},i("div",{key:"ae148f7acc58f481faac17f1b75f904b5d17bb55",ref:t=>{this.winEl=t},class:o(`${_}`),style:{maxWidth:`calc(${t} * ${this.maxViewColumns})`,maxHeight:this.panelHeight},part:"columns-panel"},this.columnList.filter((t=>t)).map(((t,s)=>i("div",{style:e,class:`${_}__column`,onScroll:m((e=>{this.columnScrollHandler(e,t)}),100),part:"column-panel","data-testid":"columns-index-ntx7Yr"},typeof this.renderColumnTitle==="function"?this.renderColumnTitle(t,s):Array.isArray(this.renderColumnTitle)?this.renderColumnTitle[s]:null,i("div",{class:`${_}__column-wrapper`},this.renderColumn(t))))),!this.columnList.length&&i("div",{key:"2adeac546128725b6169f778a7f83d6e6e12315a",style:{...e},class:o(`${_}__column`)},i("ks-empty-states",{key:"f1a670392f901b5937ba0857be5eb710a797628f",title:l(h.empty)}))))}get el(){return a(this)}};g.style=u;const k='@charset "UTF-8";ul,li{list-style:none;margin:0;padding:0}button{border:none;margin:0;padding:0;width:auto;overflow:visible;background:transparent;color:inherit;font:inherit;line-height:normal;-webkit-font-smoothing:inherit;-moz-osx-font-smoothing:inherit;-webkit-appearance:none}button::-moz-focus-inner{border:0;padding:0}.ks-text-bodyMd{font-size:var(--ks-text-bodyMd-fontSize);line-height:var(--ks-text-bodyMd-lineHeight);font-weight:var(--ks-text-bodyMd-fontWeight);letter-spacing:var(--ks-text-bodyMd-letterSpacing);font-family:var(--ks-text-bodyMd-fontFamily)}@keyframes breathing-opacity{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}.ks-skeleton,.animate-pulse{background-color:var(--ks-color-neutral-surface3);border-radius:var(--ks-border-radius-sm);animation-name:breathing-opacity;animation-duration:2s;animation-timing-function:cubic-bezier(0.455, 0, 0.55, 1);animation-fill-mode:forwards;animation-iteration-count:infinite}.ks-card-section{margin-bottom:var(--ks-spacing-400);font-size:var(--ks-text-titleMd-fontSize);line-height:var(--ks-text-titleMd-lineHeight);font-weight:var(--ks-text-titleMd-fontWeight);letter-spacing:var(--ks-text-titleMd-letterSpacing);font-family:var(--ks-text-titleMd-fontFamily)}*,:host{box-sizing:border-box}.cascader-searchlist{height:100%;overflow-y:auto}.cascader-searchlist__item{padding:var(--ks-spacing-200);display:flex;justify-content:space-between;align-items:center;border-radius:var(--ks-border-radius-md);column-gap:var(--ks-spacing-200);cursor:pointer;transition:all var(--ks-transition-functionalShort)}.cascader-searchlist__item [data-highlight]{color:var(--ks-color-primary-onSurface);background-color:var(--ks-color-primary-surface2)}.cascader-searchlist__item .cascader-searchlist__text{vertical-align:middle}.cascader-searchlist__item__left{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:var(--ks-text-bodySm-fontSize);line-height:var(--ks-text-bodySm-lineHeight);font-weight:var(--ks-text-bodySm-fontWeight)}.cascader-searchlist__item__left>*{vertical-align:middle}.cascader-searchlist__item__left--fulllabel>[ks-checkbox]{width:calc(100% - 12px)}.cascader-searchlist__item__left--fulllabel>[ks-checkbox]::part(label){display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cascader-searchlist__item:not(.cascader-searchlist__item--disabled,.cascader-searchlist__item--active,.cascader-searchlist__item--selected):hover{background-color:var(--ks-color-neutral-surface2Hover)}.cascader-searchlist__item--active{background-color:var(--ks-color-neutral-surface2Active)}.cascader-searchlist__item--selected{color:var(--ks-color-primary-onSurface);background-color:var(--ks-color-primary-surface2)}.cascader-searchlist__item--disabled{color:var(--ks-color-neutral-onSurfaceDisabled);cursor:not-allowed}.cascader-searchlist__item--disabled.cascader-searchlist__item--selected,.cascader-searchlist__item--disabled.cascader-searchlist__item--active{background-color:var(--ks-color-primary-surface1)}.cascader-searchlist__item+.cascader-searchlist__item{margin-top:var(--ks-spacing-50)}';const v="cascader-searchlist";const y=class{constructor(e){t(this,e);this["ks-name"]="ks-cascader-searchlist";this.valueKey="value";this.labelKey="label";this.disabledKey="disabled";this.multiple=false}multipleChangeItem(t,e){e?this.addSelectedFullValue?.(t):this.removeSelectedFullValue?.(t)}singleActiveItem(t,e){!e&&this.updateSelectedFullValue?.(t)}renderItem(t){const e=`${v}__item`;const s=t[c.FULL_PATH_KEY].some((t=>this.datasourceMap[t]?.disabled));const a=t[this.labelKey];const n=t[this.disabledKey]||this.disabled||s;const r=t[this.labelKey].toLowerCase().indexOf(this.queryString.toLowerCase());const l=r>-1?i("ks-text",{class:`${v}__text`,ellipsis:true,variant:"bodySm"},r>0&&i("span",null,a.toString().slice(0,r)),i("span",{"data-highlight":true},a.slice(r,this.queryString.length+r)),r+this.queryString.length<a?.length&&i("span",null,a.toString().slice(this.queryString.length+r))):i("ks-text",{ellipsis:true,variant:"bodySm"},a);if(this.multiple){const{selected:s,isIndeterminate:a}=this.treeMap.isSelectedInMultipleMode(t,this.selectedFullValue,this.checkStrategy);return i("div",{class:o(`${e}`,{[`${e}--selected`]:s||a,[`${e}--disabled`]:n}),part:"item"},i("div",{class:o(`${e}__left`,`${e}__left--fulllabel`),part:"item-left"},i("ks-checkbox",{checked:s,indeterminate:a,disabled:n,onKsChange:({detail:e})=>{this.multipleChangeItem(t,e)},"data-testid":"searchlist-index-mUbuQW"},l)))}else{const s=this.treeMap.isSelectedInSingleMode(t,this.selectedFullValue);return i("div",{class:o(`${e}`,{[`${e}--selected`]:s,[`${e}--disabled`]:n}),onClick:()=>{this.singleActiveItem(t,n)},part:"item","data-testid":"searchlist-index-qkjYC8"},i("div",{class:o(`${e}__left`),part:"item-left"},l))}}render(){return i(s,{key:"08a0437d49a1e80fcbf3cf73eeb68580c4124a92"},i("div",{key:"0efc014a3b9670ec17c2438a70678ee00e3b7a44",class:o(`${v}`),style:{width:this.displayWidth,height:this.panelHeight}},this.dataSource.length?this.dataSource.map((t=>this.renderItem(t))):i("ks-empty-states",{title:l(h.empty)})))}get el(){return a(this)}};y.style=k;export{g as ks_cascader_columns,y as ks_cascader_searchlist};